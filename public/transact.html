<!DOCTYPE html>
<html>

<head>
    <title>Stellar Thrust</title>
    <link rel="stylesheet" type="text/css" href="css/main.css"/>
</head>

<body>
    <div class="purchase">
        <h1>Purchase Stellar Thrust COINS using COS</h1>
        <h2>1 COS = </h2>
        <div class="coin"><img src="static/coin.png" width="100px" height="99px"/> <h2>X     10 [ IGW Coins ] </h2></div>
        <div id="purchase" class="purchase-btn"><h2>Purchase Now<h2></div>
    </div>
    <div class="main-char"><img src="static/lead.png" /></div>
    <div class="boss"><img src="static/boss.png" /></div>    

    <script src="https://cdn.jsdelivr.net/npm/@coschain/cosjs@1.2.1/dist/cosjs.min.js"></script>
    <script>
        let cos = new Cos("test", "https://testnode.contentos.io");
		
		// Adding sample accounts
		
        cos.wallet.addAccount("gaharavara", "41ZrRD5E1t7u5B8BsMUwCUGDYey1E7CdTDc93ikeUdhGgz9gL6");
		cos.wallet.addAccount("mralien", "4Dwemkhdw1b9L2AUmrBXhaJZeEnGC8X7FNkv5bFrh89yZfivQV"); // Contract holder


// Creating our Own Tokens

// Just need to be executed once exactly after the contract creation.
// IGW [InterGalacticWarriors is the abbrevation of our in-game currency]

/*
        (async () => {
            let result = await cos.wallet.contractCall("mralien", "mralien", "space_thrust", "create", "[\"mralien\", \"IGW\", 10000000, 3]", "0.000000");
            console.log(result.invoice);
        })();
*/

document.getElementById("purchase").onclick = function() {
// For transfer of in-game coins
// Logic for transacting 10 IGW for 1 COS        
alert("transact");
        (async () => {
            
            // First transfer 1 COS to contract holder i.e. developers
            let result = await cos.wallet.transfer("gaharavaraa", "mralien", "1.000000","memo");
            console.log(result);

            // In case of a successfull transaction, send 10 IGW coins to the user
            if(result.trxId != "") {
            let result = await cos.wallet.contractCall("mralien", "mralien", "space_thrust", "transfer", "[\"mralien\", \"gaharavara\", 10]", "0.000000");
            console.log(result.invoice);
            }

        })();
}       
    </script>
</body>

</html>
